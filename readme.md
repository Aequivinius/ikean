# Structure

The `generate` package, unsurprisingly, *generates* the `site` in 3 different languages. The content either comes from plain strings in the the `site_content/translations.json`, or from `.md` files if it needs more layout.

A checkerboard is an instragram-like layout; made of individual *fields*. Each field has its content with structured data, free text, images and models organised in simple directories. For each site to be generated, `generate` looks for a directory in `site_content`, which in turn contains the field directories. For example, to generate the `aspects.html`, you need to have an `site_content/aspects` folder.

The structure of such a field directory is as follows (with a *toy* as an example):

```
toys
|-- id (for example: hanachirusato)
    |-- toy.json
    |-- en.md (fixed name)
    |-- de.md (if missing, it will be generated by the i18n module)
    |-- jp.md
    |-- photo1.jpg (name is not important)
    |-- ... (more photos)
    |-- model.glb (needs to end in .glb)
    |-- poster.jpg (needs to be called poster)
|-- id (for example: ryouhi)
    |-- ...
```

The `toy.json` at least contains (also see `toys/template/toy.json`):

```json
{
    "category": "chashaku" /* will be translated according to the translations.json */,
    "name": {
        "en": "Ryouhi",
        "de": "Ryouhi",
        "jp": "両樋"
    },
    "price": 80,
    "on_sale": true,
    "maker": {
        "en": "Rikyu",
        "de": "Rikyu",
        "jp": "利休"
    }
}
```

The `.md` files also support `[[wikilinks]]`, which will point to [tea.hedonisms.ch](https://tea.hedonisms.ch/wiki).

# Translations
* the `generate.py` creates multilingual sites based on the `templates/translations.json`. The latter has the following format:

```json
{ "key" : { "de" : "Lohrem ipsett dohler amen.",
            "en" : "Lorem ipsum dolor amet.",
            "jp" : "ロレム　イップスム　ドロル　アメト。"} }
```

It is converted by `generate.py` into a different format where `key`s are sorted *under* `language`.

# CSS
* stick to [BEM](https://getbem.com/introduction/) naming convention
* we're following a mobile-first approach, so all desktop styling lives in `styles-768.css`

# Dev
* Use `poetry shell` then `code .` to get the `poetry` environment in VS Code

# Backlog
- [ ] write doc strings
- [ ] write and run the `pytest`s, then register them on merges
- [ ] JSON schema for checkerboards
- [ ] `order` field to sort aspects and 道具
- [ ] presentations page
- [ ] outgoing links open in new window

## i18n
- [ ] checkerboard `field__info` with `writing-mode: vertical-rl`
- [ ] add icon for machine translated articles
- [x] language switcher script that copies `#`-links
- [ ] log when files are changed so new translations can be automatically generated
- [ ] in JP site, EN should be EN
- [ ] versions for files

## Toys
- [ ] Seasonality
- [x] structured information (especially in Japanese, right now, we still have *made by* in there)
- [x] add filter for toys
- [ ] order / new items
- reduce filter on toys

## Deployment
- [x] domain
- [x] deploy

## Nice to have
- [x] better language switcher for japanese
- [ ] small footer, Impressum, instagram
- [ ] photo on intro page
